---
layout: post
title: "Problem 44 - Pentagonal numbers"
date: 2016-05-20 11:03
mathjax: true
number: 44
---

## Question

Pentagonal numbers are generated by the formula, $$P_n=\frac{1}{2}n(3n-1)$$. The first ten pentagonal numbers are:


$$
1,5,12,22,35,51,70,92,117,145,\dots
$$


It can be seen that $$P_4+P_7=22+70=92=P_8$$. However, their difference, $$70-22=48$$, is not pentagonal.

Find the pair of pentagonal numbers, $$P_j$$ and $$P_k$$, for which their sum and difference are pentagonal and $$D=\lvert P_j - P_k\rvert $$.

## Answer

Just like [Problem 42]({{ site.baseurl }}{% post_url 2016-05-18-Problem-42---Coded-triangle-numbers %}), we need to test if a given number is a pentagonal number. Solving the equation by using the quadratic formula, and throwing out the negative answer, we get,


$$
n=\frac{1+\sqrt{24P_n+1}}{6}
$$


In other words, we need to test if both $$P_j+P_k$$ and $$\lvert P_k-P_j \rvert$$ return natural numbers when plugged in to the equation above. To get rid of the pesky absolute value signs, we'll assume that $$k>j$$. Now, since we are minimizing a difference, both $$P_k$$ and $$P_j$$ need to be as close as possible to each other. If we set $$P_k$$ in stone, then we can loop $$P_j$$ over all pentagonal numbers, starting from $$P_k$$ and going down. The first sum and difference we encounter that are pentagonal numbers themselves is our answer.

Therefore, this problem can be solved using two for loops: One to increase $$P_k$$, and the other to check all pentagonal numbers below $$P_k$$. Notice the small function to determine if a number $$x$$ is a pentagonal numbers.

```python
def isPentagonal(x):
    n = ((24 * x + 1) ** 0.5 + 1) / 6
    return int(n) == n

notFound = True
k = 2
while notFound:
    Pk = k * (3 * k - 1) // 2
    for j in range(k - 1, 0, -1):
        Pj = j * (3 * j - 1) // 2
        if isPentagonal(Pk + Pj) and isPentagonal(Pk - Pj):
            print(Pk - Pj)
            notFound = False
            break
    k += 1
```

The output of the above is,

```python
5482660
2.5649144140300306 seconds.
```

Thus, $$D=\boxed{5482660}$$.