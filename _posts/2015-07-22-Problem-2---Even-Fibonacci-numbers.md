---
layout: post
title: "Problem 2 - Even Fibonacci numbers"
date: 2015-07-22 18:22
mathjax: true
number: 2
---

## Question

Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:

<p align="center">
    1, 2, 3, 5, 8, 13, 21, 34, 55, 89
</p>

By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.

## Answer

Like before, we can go through the Fibonacci numbers, generating them and checking them as we go. 

```python
a = 1
b = 1
s = 0
while b <= 4000000:
    if b % 2 == 0:
        s += b
    temp = a + b
    a = b
    b = temp
print(s)
```

Running this results in an output of,

```
4613732
0.00011090000000002487 seconds.
```

### Bonus

However, we can also solve this analytically. Notice the Fibonacci sequence above with an extra 1 at the beginning. If we assume $$F_1$$ and $$F_2$$ correspond to the first two ones, then it turns out that every 3rd Fibonacci number is even. Why? The number 1 is odd, Now, an odd integer plus another odd integer is an **even** integer. However, an odd integer plus an even integer gives an **odd** integer. There are no instances where we have two even integers, because it starts with two odd numbers. Therefore, we need to add every 3rd Fibonacci number. Recall that there is also a closed-form formula utilizing the golden ratio: $$F_n = \frac{\Phi^n - (1-\Phi)^{n}}{\sqrt{5}}$$. Now we need to find the index of the largest Fibonacci number less than 4 million. From the [Wikipedia article](https://en.wikipedia.org/wiki/Fibonacci_number#Computation_by_rounding), the formula to find the closest index (rounded down) of a Fibonacci number is

$$
n(F) = \lfloor\log_\Phi\left(F\sqrt(5) + \frac{1}{2}\right)\rfloor
\\
n(4000000) = 33
$$


Recall that the sum of a finite geometric series is $$a_1\frac{1-r^n}{1-r}$$ where $$a_1$$ is the first term, $$r$$ is the common ratio, and $$n$$ is the number of terms of the sequence. Now we can write our summation like so:


$$
\begin{aligned}
	S &= \sum_{k=1}^{11}F_{3k}
	\\ &=
	\sum_{k=1}^{11}\frac{\Phi^{3k} - (1-\Phi)^{3k}}{\sqrt{5}}
	\\ &=
	\frac{1}{\sqrt{5}}\left(\sum_{k=1}^{11}\Phi^{3k} - \sum_{k=1}^{11}(1-\Phi)^{3k}\right)
	\\ &=
	\frac{1}{\sqrt{5}}\left(\Phi^3\frac{1-(\Phi^3)^{11}}{1-\Phi^3} - 
		(1-\Phi)^3\frac{1-((1-\Phi)^3)^{11}}{1-(1-\Phi)^3}\right)
	\\ &=
	\boxed{4613732}
\end{aligned}
$$