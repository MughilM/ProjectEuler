I"Ù<h2 id="question">Question</h2>

<p>Consider the fraction, \(n/d\), where \(n\) and \(d\) are positive integers. If \(n&lt;d\) and \(HCF(n,d)=1\), it is called a reduced proper fraction.</p>

<p>If we list the set of reduced proper fractions for \(d\leq 8\) in ascending order of size, we get:</p>

\[\frac{1}{8},\frac{1}{7},\frac{1}{6},\frac{1}{5},\frac{1}{4},\frac{2}{7},\frac{1}{3},\frac{3}{8},\mathbf{\frac{2}{5}}, \frac{3}{7},\frac{1}{2},\frac{4}{7},\frac{3}{5},\frac{5}{8},\frac{2}{3},\frac{5}{7},\frac{3}{4},\frac{4}{5},\frac{5}{6},\frac{6}{7},\frac{7}{8}\]

<p>It can be seen that there are 21 elements in this set.</p>

<p>How many elements would be contained in the set of reduced proper functions for \(d\leq 1\,000\,000\)?</p>

<h2 id="answer">Answer</h2>

<p>This is the same setup as <a href="/ProjectEuler/ProjectEuler/Problem-71-Ordered-fractions/">Problem 71</a>, but now we have to count the fractions. When is a fraction in the set? Itâ€™s when the fraction is reduced, and that is when the numerator and denominator <strong>do not share any common factors</strong>. Another word for this is that \(n\) and \(d\) are <strong>coprime</strong>. So now we need to count how many numbers are coprime to a given denominator \(d\). But wait a moment, this is just \(\phi(d)\), introduced in <a href="/ProjectEuler/ProjectEuler/Problem-69-Totient-maximum/">Problem 69</a>! So we can use the same exact moment of calculating the totients, and finally simply sum them all.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span>
<span class="n">totients</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">totients</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">totients</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">totients</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span> <span class="o">*=</span> <span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>

<span class="n">totientValues</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">totients</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">totients</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">totientValues</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
</code></pre></div></div>

<p>Running this gives an output of,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>303963552391
2.6249155 seconds.
</code></pre></div></div>

<p>Thus, there are a total of <strong>303963552391</strong> fractions in the set.</p>
:ET